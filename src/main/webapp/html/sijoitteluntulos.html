
<h1>Valinnat</h1>

<div ng-include="'partials/topNavigation.html'" />

<div class="tabsheets">

    <div ng-include="'partials/hakukohdelista.html'"></div>

    <div class="toggle-content-container overflow-x-scroll">
        <div ng-include="'partials/hakukohdeNavigation.html'" />

		<div class="tabsheets">
            <h1>{{hakukohdeModel.hakukohde.hakukohdeNimi}}</h1>
            
            <div ng-show="model.errors.length > 0" class="notification warning">
                <h3>Tietoja haettaessa tapahtui virhe</h3>
                <p ng-repeat="error in model.errors">{{error}}</p>
            </div>

            <a href="{{sijoitteluntulosExcelExport}}" class="button small excel">Vie exceliin</a>
            <a ng-click="createHyvaksymiskirjeetPDF(); $event.stopPropagation()" class="button small pdf">Luo hyväksymiskirjeet</a>
            <a ng-show="false" ng-click="createJalkiohjauskirjeetPDF(); $event.stopPropagation()" class="button small pdf">Luo jälkiohjauskirjeet</a>
			<h2>Sijoittelun tulos</h2>
			<div class="margin-vertical-2">
				
			</div>
			<div class="margin-vertical-2">
				<dl class="dl-horizontal">
					<dt>Viimeisin Ajo ID</dt>
					<dd>{{model.latestSijoitteluajo.sijoitteluajoId}}</dd>
					
					<dt>Alkaa</dt>
					<dd>{{model.latestSijoitteluajo.startMils | date:'dd.MM.yyyy HH:mm'}}</dd>
					
					<dt>Loppuu</dt>
					<dd>{{model.latestSijoitteluajo.endMils | date:'dd.MM.yyyy HH:mm'}}</dd>
				</dl>
			</div>
			<!--
			<div class="margin-vertical-2">
				<button ng-click="showSijoitteluajot()">Näytä kaikki sijoitteluajot</button>
				<table class="virkailija-table-1">
					<thead>
						<tr>
							
						</tr>
					</thead>
					<tbody>
						<tr>

						</tr>
					</tbody>
				</table>
			</div>
		-->
            <h1>{{jono.aloituspaikat}}</h1>
			<div class="margin-vertical-2 overflow-x-scroll">
				<h2>Viimeisimmän sijoittelun tulokset</h2>
                <div ng-repeat="jono in model.sijoitteluTulokset.valintatapajonot">
                    <table class="virkailija-table-1">
                        <thead>
                            <tr>
                                <th colspan="8">
                                    Järjestysluku:  {{jono.prioriteetti}} /
                                    <!---Valintatapajono OID: {{jono.oid}}-->
                                    Aloituspaikat:  {{jono.aloituspaikat}} /
                                    Tasasijasaanto: {{jono.tasasijasaanto}}
                                </th>
                            </tr>
                            <tr>
                                <th>Jonosija</th>
                                <th>Tasasijan jonosija</th>
                                <th>Hakija</th>
                                <th>Hakemus</th>
                                <th>Hakutoive</th>
                                <th>Sijoittelun tila</th>
                                <th>Vastaanottotieto</th>
                                <th>Muokkaa</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="hakemus in jono.hakemukset">
                                <td>{{hakemus.jonosija}}</td>
                                <td>{{hakemus.tasasijaJonosija}}</td>
                                <td>
                                    <span title="Sukunimi">{{hakemus.etunimi}}</span>,
                                    <span title="Etunimi">{{hakemus.sukunimi}}</span>
                                </td>
                                <td>
                                    <span title="HakemusOid">
                                        <a href="{{HAKEMUS_UI_URL_BASE}}/virkailija/hakemus/{{hakuOid}}/esikatselu/{{hakemus.hakemusOid}}" target="_blank" >
                                            {{hakemus.hakemusOid}}
                                        </a>
                                    </span>
                                </td>
                                <td>{{hakemus.prioriteetti}}</td>
                                <!--
                                    <td><input type="checkbox" ng-model="hakemus.harkinnanvarainen" disabled /></td>
                                -->
                                <td>
                                    <span>{{hakemus.tila}}</span>
                                    <span ng-if="hakemus.hyvaksyttyHarkinnanvaraisesti == true">(Harkinnanvaraisesti)</span>
                                </td>


                                <td class="leftorientedcolumn">
                                    <div ng-show="((updateOrg && hakemus.tila == 'HYVAKSYTTY') || (updateOph))">
                                        <span ng-if="hakemus.tila == 'HYVAKSYTTY' && hakemus.hakemuksentila == ''">
                                          <select ng-model="hakemus.muokattuTila">
                                              <option value="">Kesken</option>
                                              <option value="ILMOITETTU">Hakijalle ilmoitettu</option>
                                          </select>
                                        </span>
                                        <span ng-if="hakemus.tila == 'HYVAKSYTTY' && hakemus.hakemuksentila == 'ILMOITETTU'">
                                            <select ng-model="hakemus.muokattuTila">
                                                <option value="ILMOITETTU">Hakijalle ilmoitettu</option>
                                                <option value="VASTAANOTTANUT_LASNA">Vastaanottanut läsnäolevana</option>
                                                <option value="VASTAANOTTANUT_POISSAOLEVA">Vastaanottanut poissaolevana</option>
                                                <option value="EI_VASTAANOTETTU_MAARA_AIKANA">Ei vastaanotettu määräaikana</option>
                                                <option value="PERUNUT">Perunut</option>
                                            </select>
                                        </span>
                                        <span ng-if="!(hakemus.tila == 'HYVAKSYTTY' && hakemus.hakemuksentila == 'ILMOITETTU') && !(hakemus.tila == 'HYVAKSYTTY' && hakemus.hakemuksentila == '')">
                                            <span ng-if="hakemus.hakemuksentila == 'ILMOITETTU'">Hakijalle ilmoitettu</span>
                                            <span ng-if="hakemus.hakemuksentila == 'VASTAANOTTANUT_LASNA'">Vastaanottanut läsnäolevana</span>
                                            <span ng-if="hakemus.hakemuksentila == 'VASTAANOTTANUT_POISSAOLEVA'">Vastaanottanut poissaolevana</span>
                                            <span ng-if="hakemus.hakemuksentila == 'EI_VASTAANOTETTU_MAARA_AIKANA'">Ei vastaanotettu määräaikana</span>
                                            <span ng-if="hakemus.hakemuksentila == 'PERUNUT'">Perunut</span>
                                        </span>
                                    </div>
                                </td>
                                <td>
                                    <a ng-disabled="!(updateOph)" ng-click="showMuutaHakemus(hakemus)" class="button small">Tila</a>
                                    <div ng-include="'valintalaskentatulos-partials/muutaHakemus.html'"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <a ng-click="submit(jono.oid)" class="button small primary margin-top-2" >Tallenna</a>
                </div>
            </div>
		</div>
	</div>
	<div class="clear"></div>
</div>
