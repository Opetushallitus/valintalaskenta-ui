
<h1>Valinnat</h1>

<div ng-include="'partials/topNavigation.html'" />

<div class="tabsheets">

    <div ng-include="'partials/hakukohdelista.html'"></div>

    <div class="toggle-content-container overflow-x-scroll">

        <h1 class="margin-horizontal-1 margin-bottom-3">{{hakukohdeModel.hakukohde.hakukohdeKoodistoNimi}}</h1>
        <div ng-include="'partials/hakukohdeNavigation.html'" />

		<div class="tabsheets">

            <div ng-show="model.errors.length > 0" class="notification warning">
                <h3>Tietoja haettaessa tapahtui virhe</h3>
                <p ng-repeat="error in model.errors">{{error}}</p>
            </div>

            <div class="margin-vertical-2">
                Viimeisimmät sijoittelun tulokset. Sijoitteluajo on alkanut  <strong>{{model.latestSijoitteluajo.startMils | date:'dd.MM.yyyy HH:mm'}}</strong>
                ja loppunut <strong>{{model.latestSijoitteluajo.endMils | date:'dd.MM.yyyy HH:mm'}}</strong>. Sijoitteluajon tunniste on <strong>{{model.latestSijoitteluajo.sijoitteluajoId}}</strong>.
                Sijoittelu suoritetaan kerran vuorokaudessa.
            </div>

            <a ng-click="sijoittelunTulosXLS(); $event.stopPropagation()" class="button small excel">Vie exceliin</a>
            <a ng-click="createHyvaksymiskirjeetPDF(); $event.stopPropagation()" class="button small pdf">Luo hyväksymiskirjeet</a>
            <a ng-show="false" ng-click="createJalkiohjauskirjeetPDF(); $event.stopPropagation()" class="button small pdf">Luo jälkiohjauskirjeet</a>
			<div class="margin-vertical-2 overflow-x-scroll">
                <div ng-repeat="jono in model.sijoitteluTulokset.valintatapajonot">
                    <table class="virkailija-table-1">
                        <thead>
                            <tr>
                                <th colspan="8">
                                    Valintatapajono:  {{jono.prioriteetti}} /
                                    <!---Valintatapajono OID: {{jono.oid}}-->
                                    Aloituspaikat:  {{jono.aloituspaikat}} /
                                    Tasasijasaanto: {{jono.tasasijasaanto}}
                                </th>
                            </tr>
                            <tr>
                                <th>Jonosija</th>
                                <th>Tasasijan jonosija</th>
                                <th>Hakija</th>
                                <th>Hakemus</th>
                                <th>Hakutoive</th>
                                <th>Sijoittelun tila</th>
                                <th>Vastaanottotieto</th>
                                <th>Muokkaa</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-repeat="hakemus in jono.hakemukset">
                                <td>{{hakemus.jonosija}}</td>
                                <td>{{hakemus.tasasijaJonosija}}</td>
                                <td>
                                    <span title="Sukunimi">{{hakemus.etunimi}}</span>,
                                    <span title="Etunimi">{{hakemus.sukunimi}}</span>
                                </td>
                                <td>
                                    <span title="HakemusOid">
                                        <a href="{{HAKEMUS_UI_URL_BASE}}/virkailija/hakemus/{{hakuOid}}/esikatselu/{{hakemus.hakemusOid}}" target="_blank" >
                                            {{hakemus.hakemusOid}}
                                        </a>
                                    </span>
                                </td>
                                <td>{{hakemus.prioriteetti}}</td>
                                <!--
                                    <td><input type="checkbox" ng-model="hakemus.harkinnanvarainen" disabled /></td>
                                -->
                                <td>
                                    <span>{{hakemus.tila}}</span>
                                    <span ng-if="hakemus.hyvaksyttyHarkinnanvaraisesti == true">(Harkinnanvaraisesti)</span>
                                    <span ng-if="hakemus.varasijanNumero != undefined">({{hakemus.varasijanNumero}})</span>
                                </td>


                                <td class="leftorientedcolumn">
                                    <div ng-show="((updateOrg && hakemus.tila == 'HYVAKSYTTY') || (updateOph))">
                                        <span ng-if="hakemus.tila == 'HYVAKSYTTY' && hakemus.vastaanottoTila == ''">
                                          <select ng-model="hakemus.muokattuVastaanottoTila">
                                              <option value="">Kesken</option>
                                              <option value="ILMOITETTU">Hakijalle ilmoitettu</option>
                                          </select>
                                        </span>
                                        <span ng-if="hakemus.tila == 'HYVAKSYTTY' && hakemus.vastaanottoTila == 'ILMOITETTU'">
                                            <select ng-model="hakemus.muokattuVastaanottoTila">
                                                <option value="ILMOITETTU">Hakijalle ilmoitettu</option>
                                                <option value="VASTAANOTTANUT_LASNA">Vastaanottanut läsnäolevana</option>
                                                <option value="VASTAANOTTANUT_POISSAOLEVA">Vastaanottanut poissaolevana</option>
                                                <option value="EI_VASTAANOTETTU_MAARA_AIKANA">Ei vastaanotettu määräaikana</option>
                                                <option value="PERUNUT">Perunut</option>
                                            </select>
                                        </span>
                                        <span ng-if="!(hakemus.tila == 'HYVAKSYTTY' && hakemus.vastaanottoTila == 'ILMOITETTU') && !(hakemus.tila == 'HYVAKSYTTY' && hakemus.vastaanottoTila == '')">
                                            <span ng-if="hakemus.vastaanottoTila == 'ILMOITETTU'">Hakijalle ilmoitettu</span>
                                            <span ng-if="hakemus.vastaanottoTila == 'VASTAANOTTANUT_LASNA'">Vastaanottanut läsnäolevana</span>
                                            <span ng-if="hakemus.vastaanottoTila == 'VASTAANOTTANUT_POISSAOLEVA'">Vastaanottanut poissaolevana</span>
                                            <span ng-if="hakemus.vastaanottoTila == 'EI_VASTAANOTETTU_MAARA_AIKANA'">Ei vastaanotettu määräaikana</span>
                                            <span ng-if="hakemus.vastaanottoTila == 'PERUNUT'">Perunut</span>
                                        </span>
                                    </div>
                                </td>
                                <td>
                                    <a ng-disabled="!(updateOph)" ng-click="showMuutaHakemus(hakemus)" class="button small">Tila</a>
                                    <div ng-include="'valintalaskentatulos-partials/muutaHakemus.html'"/>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                    <a ng-click="submit(jono.oid)" class="button small primary margin-top-2" >Tallenna</a>
                </div>
            </div>
		</div>
	</div>
	<div class="clear"></div>
</div>
